---
import { SITE_TITLE } from '../consts';
import ThemeToggle from './ThemeToggle.astro';

const pathname = Astro.url.pathname;
---

<header>
  <nav>
    <a href="/" class="logo">{SITE_TITLE}</a>
    <div class="nav-right">
      <div class="nav-links">
        <a href="/blog" class:list={[{ active: pathname.startsWith('/blog') }]}>Blog</a>
        <a href="/projects" class:list={[{ active: pathname === '/projects' || pathname === '/projects/' }]}>Projects</a>
        <a href="/about" class:list={[{ active: pathname === '/about' || pathname === '/about/' }]}>About</a>
      </div>
      <ThemeToggle />
    </div>
  </nav>
</header>

<!-- Inline script to prevent flash of wrong theme -->
<script is:inline>
  (function() {
    const theme = localStorage.getItem('theme') ||
      (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    document.documentElement.setAttribute('data-theme', theme);
  })();
</script>

<style>
  header {
    position: sticky;
    top: 0;
    z-index: 100;
    background-color: var(--bg);
    border-bottom: 1px solid var(--border);
    transition: background-color 0.2s ease, border-color 0.2s ease;
  }

  nav {
    display: flex;
    align-items: center;
    justify-content: space-between;
    max-width: var(--content-width);
    margin: 0 auto;
    padding: var(--spacing-sm);
  }

  .logo {
    font-weight: 700;
    font-size: 1.125rem;
    color: var(--text);
    text-decoration: none;
  }

  .logo:hover {
    color: var(--accent);
    text-decoration: none;
  }

  .nav-right {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
  }

  .nav-links {
    display: flex;
    gap: var(--spacing-md);
  }

  .nav-links a {
    color: var(--text-muted);
    text-decoration: none;
    font-size: 0.9rem;
    transition: color 0.15s ease;
  }

  .nav-links a:hover,
  .nav-links a.active {
    color: var(--text);
  }

  @media (max-width: 480px) {
    .nav-links {
      gap: var(--spacing-sm);
    }

    .nav-links a {
      font-size: 0.85rem;
    }
  }
</style>
